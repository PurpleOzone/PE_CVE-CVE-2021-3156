# PE_CVE-CVE-2021-3156
Exploit for Ubuntu 20.04 using CVE-2021-3156 enhanced with simple post-exploitation scripts

## PoC for the PE_CVE-CVE-2021-3156.

### Requirements

![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/6cdd3ad0-34af-4b29-81d9-838c757b046f)


### Exploit

The exploit can work as long as access to the victim system is gained with a user without considerable privileges.

![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/b86c0ad5-32bf-4b9e-9270-a0c3a1434dc7)

You can clone the repo to the victim´s machine or your local machine and load it with wget

![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/064ba0d1-88be-4347-b20f-08dc80fc7747)

Execute the command "make" to compile the .c files according to the vulnerability
![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/8d486f7e-7c06-456c-be71-1ec5e775e64b)

You´ll get the exploit file, so youu can run it with "./"
You can now see two files generated in the repository, one that holds all the ssh keys registered on the system and the executable SUID file that grants a root session to all users. (highlighted in purple)
![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/cdc903a9-2c55-4596-a2c5-2e3ea9f02d31)

You might see an error like the following one:
![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/2dcb86bf-d1b7-4c62-87a5-fc23b084431a)

I'm still trying to resolve the error, but I assume it's the shell that generates the exploit. I tried running the ./create_privshell.sh command from root by accessing with sudo su from a user with appropriate permissions and the script compilation was fine.

![image](https://github.com/PurpleOzone/PE_CVE-CVE-2021-3156/assets/111320119/3a30fa3d-9d88-4080-9120-a1caa3f7d5b4)




